<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="portal_my_home" name="Portal My Home: Conversaciones" inherit_id="portal.portal_my_home" priority="30">
        <xpath expr="//div[hasclass('o_portal_docs')]" position="inside">
            <br/>
			
			<t t-if="channel_count" t-call="portal.portal_docs_entry">
              <t t-set="title">Conversaciones</t>
              <t t-set="url" t-value="'/my/messages'"/>
              <t t-set="count" t-value="channel_count"/>
			 </t>
		


		
        </xpath>
    </template>



    <template id="portal_my_messages" name="Mis Conversaciones">
      <t t-call="portal.portal_layout">
            <t t-set="breadcrumbs_searchbar" t-value="True"/>
            <t t-call="portal.portal_searchbar">
                <t t-set="title">Conversaciones</t>
                  
				</t>
            <t t-if="not msgchan">
                <p>No Hay Conversaciones.</p>
            </t>
            <t t-if="msgchan" t-call="portal.portal_table">
				<thead>
                    <tr class="active">
                        <th class="col-md-8">ID Mensaje</th>
                        <th class="col-md-8">Creado el</th>
						<th class="col-md-8">Tipo Canal</th>
						<th class="col-md-8">Nombre</th>
						<th class="col-md-8">Asistentes</th>
						<th class="col-md-8">Canal</th>
						<th class="col-md-8">Chat Cerrado</th>
						<th class="col-md-8">Conversación</th>
                    </tr>
                </thead>
                <tbody>
                    <tr t-foreach="msgchan" t-as="msgid">
					<t t-if="msgid.chatuser.id == current_user"> 
  					    <td>
                          #<span t-field="msgid.id"/>
                        </td>
  					    <td>
                          <span t-field="msgid.create_date"/>
                        </td>
                       <td>
                         <span t-field="msgid.channel_type"/>
                        </td>
                       <td>
                          <span t-field="msgid.chatuser"/>
                        </td>
                       <td>
                         <span t-field="msgid.name"/>
                        </td>

                       <td>
                         <span t-field="msgid.livechat_channel_id"/>
                        </td>
                       <td>
                         <t t-if="msgid.chatcerrado == True"> 
                         SI
                         </t>
                        </td>

                       <td>
   						<a t-attf-href="/my/messages/#{msgid.id}?{{ keep_query() }}">
                                VER
                         </a>
                        </td>
				    </t>
                    </tr>
                </tbody>
            </t>
        </t>
    </template>




 <template id="my_messages_messages" name="Mi Mensaje">
        <t t-call="portal.portal_layout">
            <div class="card">
              <div ><a href="/my/messages">Volver a Listado de Mensjaes</a></div>
                <div class="card-header">
				 
                    <div class="row">
                        <div class="col-lg-12">
                            <h2>
                               
                                 <span t-field="msgids.livechat_channel_id"/>::  <span t-field="msgids.name"/>                         

                                 
								 <t t-if="msgids.chatcerrado == True"> 
								 :: <font color="red">  <b>	 CHAT CERRADO</b></font>
                                 </t>
                                
								
                            </h2>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="mb8">
                        <strong>ID:</strong>
                        #<span t-field="msgids.id"/>
                    </div>
                    <div class="mb8">
                        <strong>Fecha:</strong>
                        <span t-field="msgids.create_date"/>
                    </div>
                    <div class="mb8">
                        <strong>Chat Cerrado:</strong>

                    </div>

					
                    <div class='row'>
                        <div t-if="msgids.create_uid" class="col-md-6">
                            <strong>Tipo de Canal</strong>
                            <span t-field="msgids.channel_type"/>

                        </div>
				  </div>
                    
				
				</div>
            </div>



                 
						
	 <div id="message2_communication" class="col-lg-12">
                <br/><h4>Detalle Conversación</h4>
				<t t-if="msgids.message_ids">
                        <table border="1"  bordercolor="#CCCCCC" width="100%" cellspacing="10" cellpadding="10">
						<thead>
                            <tr >
							<th >Mensaje</th>
							<th >Quien</th>
							<th >Fecha</th>

                          </tr>
						</thead>
						<tbody>
							<tr bordercolor="#000000" bgcolor= "white" border="1" t-foreach="msgids.message_ids" t-as="ticketint">
								<td width="65%"> <span t-field="ticketint.body"/> </td>
                                <td> <span t-field="ticketint.author_id"/> </td>
								<td> <span t-field="ticketint.date"/> </td>

                            </tr>
						</tbody>
						</table>
				</t>
            </div>					

        </t>
    </template>




</odoo>
