<odoo>
  <data>

<!-- **************************************** VISTAS **************************************** -->

  <record id="pyme_rasa_users_bot_view_form" model="ir.ui.view">
    <field name="name">pyme_rasa_users_bot_view_form</field>
    <field name="model">res.users</field>
    <field name="inherit_id" ref="base.view_users_form"/>
    <field name="arch" type="xml">
      <field name="login" position="replace">
        
		<div><h4>Es un Bot: <field name="esunbot"/></h4>
		</div>
		<h2><field name="login" attrs="{'readonly': [('esunbot', '=', True)]}"/></h2>
	  </field>
      <field name="rasabot_state" position="replace">
		<h2><field name="rasabot_state" attrs="{'readonly': [('esunbot', '=', True)]}"/></h2>
	  </field>
      <field name="name" position="replace">
		 <h1><field name="name" attrs="{'readonly': [('esunbot', '=', True)]}" required="1"/></h1>
	  </field>

    </field>
  </record>


    <!-- Vista arbol Rasa Server -->
    <record model="ir.ui.view" id="rasa_server_view_tree">
        <field name="name">Rasa Server view_tree</field>
        <field name="model">rasa.server</field>
        <field name="arch" type="xml">
            <tree string="Rasa Server" import="false" >
                <field name="name"/>
                <field name="url"/>
              <field name="urlx"/>
                <field name="state"/>
            </tree>
        </field>
    </record>

    <!-- Vista Form Rasa Server -->
    <record model="ir.ui.view" id="rasa_server_view_form">
        <field name="name">Rasa Server view_form</field>
        <field name="model">rasa.server</field>
        <field name="arch" type="xml">
            <form string="Rasa Server" create="false" import="false" delete="false" duplicate="false">
                <header>
            <button name="probar_conexion" string="Probar conexion" type="object" states="draft,error"/>
            <button name="cerrar_conexion" class="oe_highlight" string="Desconectar" type="object" states="connected" confirm="Esta Accion Desconectará el actual Rasa Server y afectará a los BOT conectados a el. ¿Estas Seguro?"/>
            <button name="form_recargar_rasa" string="Guardar y Recargar Rasa" type="object" states="connected" class="oe_read_only" icon="fa-bolt" attrs="{'invisible':[('localhosturl','!=',True)]}"/>
            <button name="editor" string="Abrir Editor" type="object" states="connected" class="oe_read_only" icon="fa-table" attrs="{'invisible':[('localhosturl','!=',True)]}"/>
            
			          </header>
          <sheet>
            <h1 class="mt0">
              <div >
                <field name="name"/>
              </div>

            </h1>
            <group>
              <group>

                <field name="localhosturl" invisible="1"/>
                <label for="url" string="Rasa Server"/>
                <div>
                  <field name="url" class="oe_inline" help="IP Servidor Rasa" attrs="{'invisible':[('localhosturl','=',True)]}"/>
                  <label for="url" class="oe_inline" attrs="{'invisible':[('localhosturl','!=',True)]}" string="localhost"/>
                  <label for="url" string=" / " class="oe_inline"/>
                  <field name="puertorasa" class="oe_inline" help="Puerto API Rasa"/>
                  <br/>
                </div>
                <field name="direccionagente" class="oe_inline" attrs="{'invisible':[('localhosturl','!=',True)],'readonly':[('state','=','connected')]}"/>
                
                
                <label for="urlx" string="Rasa X"/>
                <div>
                  <field name="urlx" class="oe_inline" help="IP Servidor Rasa X"/>
                  <label for="url" string=" / " class="oe_inline"/>
                  <field  help="Puerto HTTP Rasa X" name="puertorasax" class="oe_inline"/>
                </div>
                <field name="passwordx"  password="True"/>
                <field name="state" invisible="1"/>

			  </group>
              <group>
                <h2><field name="state"/></h2>
                <h2>
                  <button name="abrirrasax" string="Abrir Rasa-X" type="object" states="connected"/>
                </h2>
                <field name="stringconexion" readonly="1"/>
              </group>
            </group>
                <notebook>
                <page string="Mensajes Predefinidos">
                 <group>
                   <field name="saludoinicial"/>
                   <field name="salidaerror"/>
                   <field name="salidavacia"/>
                   <field name="salidanoentiendo"/>				   
			     </group>
                </page>
				<page string="Conexion Rasa Server">
                 <group>
                   <field name="sshuser"/>
                   <field name="sshpass"  password="True"/>
                   <field name="sshport"/>				
			     </group>
                </page>
                <page string="Cadena Conexion Odoo">
                 <group>
                 <group string="API ODOO">
                   <field name="odoourl"/>
                   <field name="odoodb"/>
                   <field name="odoouser"/> 
                   <field name="odoopass"  password="True"/>
			      </group>
                 <group string="SQL ODOO">
                  <label for="sqlurl" string="Servidor:Puerto"/>
				  <div>
                   <field name="sqlurl" class="oe_inline"/>
				    <label for="sqlport" string=" : " class="oe_inline"/>
				   <field name="sqlport" class="oe_inline"/>
				   </div>
                   <field name="sqldb" readonly="1"/>
                   <field name="sqluser"/> 
                   <field name="sqlpass"  password="True"/>
			      </group>

			     </group>
                </page>
				</notebook>
             
		  
		  </sheet>
            </form>
        </field>
    </record>


    <record model="ir.ui.view" id="rasa_server_restartview_form">
      <field name="name">rasa.server_restartview_form</field>
      <field name="model">rasa.server</field>
      <field name="arch" type="xml">
        <form string="Rasa Server" delete="false" create="false" edit="false">
          <script>
            $(document).ready(function(){
            $(".modal-header").hide();
            $(".modal-footer").hide();
            });
          </script>
          <sheet>
            <h2 class="mt0">
              <div >
                ¿Deseas Guardar y Recargar el Rasa?
              </div>

            </h2>
            <group>
              <group>
                <br/>

                <field name="backupfichero" readonly="1" help="En el Directorio Definido para el RASA se guardarán los Ficheros con el Sufijo _OLD"/>
                
              </group>
              <group>

                <button name="recargar_actions" string="Recargar Acciones" type="object" icon="fa-comments"/>
               
              </group>
            </group>

            <br/>
            <br/>
            <br/>
            
            <button special="cancel" string="Cancelar" type="object"/>&#x2063;&#x2063;&#x2063;
            <button name="recargar_rasa" string="Guardar y Recargar Rasa" type="object" class="oe_highlight" icon="fa-bolt" confirm="Esta accion Detendrá el RASA y lo volverá a arrancar. Necesario para Credentials y Endpoints"/>
           </sheet>
        </form>
      </field>
    </record>
    
    
   
    <!-- Vista arbol Tracker -->
    <record model="ir.ui.view" id="rasa_odootracker_view_tree">
      <field name="name">Rasa - Odoo Tracker</field>
      <field name="model">events</field>
      <field name="arch" type="xml">
        <tree string="Rasa Tracker" create="false">
          <field name="sender_id"/>
          <field name="type_name"/>
          <field name="intent_name"/>
          <field name="action_name"/>
          <field name="data"/>

        </tree>
      </field>
    </record>


    <!-- Vista arbol Tracker -->
    <record model="ir.ui.view" id="rasa_odooconversa_view_tree">
      <field name="name">Rasa - Odoo Conversaciones</field>
      <field name="model">mail.message</field>
      <field name="arch" type="xml">
        <tree string="Rasa Odoo Conversaciones" create="false">
          <field name="date"/>
          <field name="author_id"/>
          <field name="body"/>
          
        </tree>
      </field>
    </record>

    <record model="ir.ui.view" id="rasa_odooconversa2_view_search">
      <field name="name">Rasa - Odoo Conversaciones</field>
      <field name="model">mail.channel</field>
      <field name="arch" type="xml">
         <search string="Search Invoice">
              <field name="id"/>
			  <field name="create_date"/>
              <field name="name" string="Asistentes"/>
			  <field name="message_ids" string="Mensaje Contiene..." filter_domain="[('message_ids.body', 'ilike', self)]"/>
            <separator/>			 
			 <filter name="canalweb" string="Chat WEB" domain="[('livechat_channel_id','=', 1)]"/>
			 <filter name="canalweb2" string="Chat Telegram" domain="[('livechat_channel_id','=', 2)]"/>
			 <filter name="canalweb3" string="Tiene Canal Asociado" domain="[('livechat_channel_id','!=', False)]"/>
            <separator/>
               <group expand="0" string="Agrupar Por...">
                        <filter string="Tipo de Canal" name="tipocanal" context="{'group_by':'livechat_channel_id'}"/>
                        <filter name="miembrosa" string="Miembros Agrupados" context="{'group_by':'name'}"/>
                        <separator/>
                    </group>
         </search>
      </field>
    </record>


    <record model="ir.ui.view" id="rasa_odooconversa2_view_tree">
      <field name="name">Rasa - Odoo Conversaciones</field>
      <field name="model">mail.channel</field>
      <field name="arch" type="xml">
        <tree string="Rasa Odoo Conversaciones" create="false" default_order='create_date desc'>
          <field name="id"/>
		  <field name="create_date"/>
		  <field name="channel_type"/>
          <field name="chatuser" string="Nombre"/>
          <field name="name" string="Asistentes"/>
		  <field name="livechat_channel_id"/>
          
        </tree>
      </field>
    </record>


    <record model="ir.ui.view" id="rasa_odooconversa2_view_form">
      <field name="name">Rasa - Odoo Conversaciones</field>
      <field name="model">mail.channel</field>
      <field name="arch" type="xml">
        <form string="Mail Channel Form">
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <field name="is_moderator" invisible="1"/>
                            <button class="btn oe_stat_button" name="mail.mail_moderation_action" type="action" attrs="{'invisible':[('is_moderator', '=', False)]}" icon="fa-bars" context="{'search_default_channel_id': active_id}">
                            <field string="Ban List" name="moderation_count" widget="statinfo"/>
                            </button>
                        </div>
                        <div class="oe_button_box" name="button_box"/>
                        <field readonly="1" name="image" widget="image" class="oe_avatar" options="{'preview_image': 'image_medium', 'size': [90, 90]}"/>
                        <div class="oe_title">
                            <div class="oe_edit_only">
                                <label for="name" string="Asistentes"/>
                            </div>
                            <h1>
                                <field name="name" default_focus="1" placeholder="Asistentes" readonly="1"/>
                            </h1>
                        </div>
                        <group>
						  <group class="o_label_nowrap">
                            <field name="description" placeholder="Descripción..."/>
                        </group>
						<group>
						   <field name="id" invisible="1"/>
						   <field name="livechat_channel_id" readonly="1"/>
						</group></group>
						<notebook>
                            <page string="Mensajes">
                                    <field name="message_ids" readonly="1">
										<tree>
											<field name="body" string="Mensaje"/>
											<field name="author_id" string="Quien"/>
											<field name="date" string="Fecha"/>


										</tree>								
									</field>

                            </page>
                            <page string="Miembros">
                                <field name="channel_last_seen_partner_ids" readonly="1" mode="tree" context="{'active_test': False}">
                                    <tree string="Members" editable="bottom">
                                        <field name="partner_id"/>
                                        <field name="partner_email" readonly="1"/>
                                    </tree>
                                </field>
                            </page>
                            
                        </notebook>

                    </sheet>
                </form>
            
      </field>
    </record>


 <record model="ir.ui.view" id="rasa_actions_view_form">
      <field name="name">Rasa - Editor</field>
      <field name="model">rasa.actions</field>
      <field name="arch" type="xml">
        <form string="Rasa Acciones">
          <header>
             <button name="form_recargar_rasa" string="Guardar y Recargar Rasa" type="object" class="oe_read_only" icon="fa-bolt"/>
          </header>
          <group>
            <field name="image_url" />
			<field name="img_attach" invisible="1"/>
			<field name="img_attachsrc" invisible="1"/>
			 <script>
				if(document.getElementById("img")){
					var value=document.getElementById("img").src;
					document.getElementById("custom_src").src=value; 
				}
        </script>
			<!-- 
            <iframe id="custom_src" width="100%" height="640" marginheight="0" marginwidth="0" scrolling="no" frameborder="0" src="http://192.168.50.242:5000/editor/graphpage?bot=odoorasa#"/> 
            -->
			</group>
		  <iframe id="custom_src" width="100%" height="640" marginheight="0" marginwidth="0" scrolling="no" frameborder="0" src=""/> 
		   <!-- <div id="custom_src" ></div> -->
	

         

        </form>
      </field>
    </record>



 <record model="ir.ui.view" id="rasa_server_view2_form">
      <field name="name">Rasa - Editor</field>
      <field name="model">rasa.server</field>
      <field name="arch" type="xml">
        <form string="Rasa Acciones" edit="false" create="false" delete="false" duplicate="false">
          <header>
             <button name="form_recargar_rasa" string="Guardar y Recargar Rasa" type="object" class="oe_read_only" icon="fa-bolt"/>
          </header>
		  <sheet>
		  <center><h1><label for="img_attach" string="Editor Remoto RASA"/></h1></center>
          <group>
            <field name="image_url" invisible="1"/>
			<field name="img_attach" invisible="1"/>
			<field name="img_attachsrc" invisible="1"/>
			 <script>
				if(document.getElementById("img")){
					var value=document.getElementById("img").src;
					document.getElementById("custom_src").src=value; 
				}
        </script>
			<!-- 
            <iframe id="custom_src" width="100%" height="640" marginheight="0" marginwidth="0" scrolling="no" frameborder="0" src="http://192.168.50.242:5000/editor/graphpage?bot=odoorasa#"/> 
            -->
			</group>
		  <iframe id="custom_src" width="100%" height="640" marginheight="0" marginwidth="0" scrolling="no" frameborder="0" src=""/> 
		   <!-- <div id="custom_src" ></div> -->
	

         
         </sheet>
        </form>
      </field>
    </record>



    <!-- Action RASA Server -->
    <record model="ir.actions.act_window" id="action_rasa_server">
        <field name="name">Rasa Server</field>
        <field name="res_model">rasa.server</field>
        <field name="view_mode">tree</field>
        <field name="domain">[('id','=',2)]</field>
        <field name="view_ids" eval="[(5, 0, 0),
                            (0, 0, {'view_mode': 'tree', 'view_id': ref('rasa_server_view_tree')}),
                            (0, 0, {'view_mode': 'form', 'view_id': ref('rasa_server_view_form')})]"/>
    </record>




    <record model="ir.actions.act_window" id="action_rasa_actions">
      <field name="name">Editor RASA</field>
      <field name="res_model">rasa.server</field>
      <field name="view_mode">form</field>
        <field name="view_ids" eval="[(5, 0, 0),
                            (0, 0, {'view_mode': 'tree', 'view_id': ref('rasa_server_view_tree')}),
                            (0, 0, {'view_mode': 'form', 'view_id': ref('rasa_server_view2_form')})]"/>
    </record>




    <record model="ir.actions.act_window" id="action_rasa_tracker">
      <field name="name">Rasa Tracker</field>
      <field name="res_model">events</field>
        <field name="view_mode">tree</field>
      <field name="view_ids" eval="[(5, 0, 0),(0, 0, {'view_mode': 'tree', 'view_id': ref('rasa_odootracker_view_tree')})]"/>
    </record>


    <record model="ir.actions.act_window" id="action_rasa_conversaciones">
      <field name="name">Odoo Mensajes</field>
      <field name="res_model">mail.message</field>
      <field name="domain">	[('model', '=', 'mail.channel')]</field>
      <field name="view_mode">tree</field>
      <field name="view_ids" eval="[(5, 0, 0),(0, 0, {'view_mode': 'tree', 'view_id': ref('rasa_odooconversa_view_tree')})]"/>
    </record>



    <record model="ir.actions.act_window" id="action_rasa_conversaciones2">
      <field name="name">Odoo Conversaciones</field>
      <field name="res_model">mail.channel</field>
	  <field name="search_view_id" ref="rasa_odooconversa2_view_search"/>
      <field name="view_mode">tree,form</field>
	  <field name="context">{"search_default_canalweb3": 1}</field>
        <field name="view_ids" eval="[(5, 0, 0),
                            (0, 0, {'view_mode': 'tree', 'view_id': ref('rasa_odooconversa2_view_tree')}),
                            (0, 0, {'view_mode': 'form', 'view_id': ref('rasa_odooconversa2_view_form')})]"/>
    </record>

    <!-- **************************************** ITEMS **************************************** -->

    <!-- Menú principal -->
    <menuitem id="menu_rasa" 
              name="Rasa" 
              web_icon="pyme_rasa,static/menu/rasa_logo.jpg"
              sequence="1"/>

    <menuitem id="item_rasa_server" 
              name="Rasa Server"
              parent="menu_rasa"
              action="action_rasa_server"/>

<!--    

    <menuitem id="item_odooconversaciones"
        name="Conversaciones"
        parent="menu_rasa"
        />


    <menuitem id="item_rasa_tracker"
        name="Mensajes Odoo"
        parent="item_odooconversaciones"
         action="action_rasa_conversaciones"/>

    <menuitem id="item_rasa_conversaciones"
        name="Conversaciones Odoo"
        parent="item_odooconversaciones"
         action="action_rasa_conversaciones2"/>

    <menuitem id="item_rasa_message"
        name="Rasa Tracker"
        parent="item_odooconversaciones"
        action="action_rasa_tracker"/>

-->




  </data>
</odoo>