<odoo>
  <data>

<!-- **************************************** VISTAS **************************************** -->

    <!-- Vista Calendario -->
    <record model="ir.ui.view" id="calendar.view_calendar">
        <field name="name">Pyme - Calendario view_calendar</field>
        <field name="model">calendar.event</field>
        <field name="arch" type="xml">
            <calendar string="Meetings" date_start="start" date_stop="stop" date_delay="duration" all_day="allday" readonly_form_view_id="319" event_open_popup="true" event_limit="3" color="partner_id">
                <field name="name"/>
                <field name="x_partner"/>
                <field name="partner_ids" write_model="calendar.contacts" write_field="partner_id" avatar_field="image_small" invisible="1"/>
                <field name="is_highlighted" invisible="1"/>
            </calendar>
        </field>
    </record>

    <!-- Vista arbol Tareas -->
    <record model="ir.ui.view" id="project.task_view_tree">
        <field name="name">Pyme - Tareas view_tree</field>
        <field name="model">project.task</field>
        <field name="arch" type="xml">
            <tree decoration-bf="message_needaction==True" decoration-danger="date_deadline and (date_deadline&lt;current_date)" string="Tasks">
                <field name="message_needaction" invisible="1"/>
                <field name="sequence" invisible="not context.get('seq_visible', False)"/>
                <field name="date_deadline"/>
                <field name="name"/>
                <field name="partner_id"/>
                <field name="project_id" invisible="1"/>
                <field name="user_id" invisible="1"/>
                <!-- <field name="stage_id" invisible="context.get('set_visible',False)"/>-->
            </tree>
        </field>
    </record>

    <!-- Vista formulario Tareas -->
    <record model="ir.ui.view" id="project.task_view_form">
        <field name="name">Pyme - Tareas view_form</field>
        <field name="model">project.task</field>
        <field name="arch" type="xml">
            <form string="Task" class="o_form_project_tasks">
                    <header>
                        <button name="action_assign_to_me" string="Assign to Me" type="object" class="oe_highlight" attrs="{'invisible' : [('user_id', '!=', False)]}"/>

                        <field name="stage_id" widget="statusbar" clickable="True" options="{'fold_field': 'fold'}"/>
                    </header>
                    <sheet string="Task">
                    <div class="oe_button_box" name="button_box">
                        <button class="oe_stat_button" icon="fa-tasks" type="object" name="action_open_parent_task" string="Parent Task" attrs="{'invisible' : [('parent_id', '=', False)]}" groups="project.group_subtask_project"/>
                        <button name="246" type="action" class="oe_stat_button" icon="fa-tasks" attrs="{'invisible' : [('parent_id', '!=', False)]}" context="{'project_id': subtask_project_id, 'name': name, 'partner_id': partner_id}" groups="project.group_subtask_project">
                            <field string="Sub-tasks" name="subtask_count" widget="statinfo"/>
                        </button>
                        <button name="toggle_active" type="object" groups="base.group_user" class="oe_stat_button" icon="fa-archive" invisible="1">
                            <field name="active" widget="boolean_button" options="{&quot;terminology&quot;: &quot;archive&quot;}"/>
                        </button>
                    </div>
                    <field name="kanban_state" widget="state_selection"/>
                    <div class="oe_title">
                        <h1 class="o_row">
                            <field name="priority" widget="priority"/>
                            <field name="name" placeholder="Task Title..."/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="project_id" domain="[('active', '=', True)]" invisible="1"/>
                            <field name="partner_id"/>
                            <field name="user_id" class="o_task_user_field" options="{&quot;no_open&quot;: True}" invisible="1"/>
                            <field name="legend_blocked" invisible="1"/>
                            <field name="legend_normal" invisible="1"/>
                            <field name="legend_done" invisible="1"/>
                        </group>
                        <group>
                            <field name="date_deadline"/>
                            <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color', 'no_create_edit': True}"/>
                        </group>
                    </group>
                    <notebook>
                        <page name="description_page" string="Description">
                            <field name="description" type="html"/>
                            <div class="oe_clear"/>
                        </page>
                        <page name="extra_info" string="Extra Info" invisible="1">
                            <group>
                                <group>
                                    <field name="sequence" groups="base.group_no_one"/>
                                    
                                    <field name="email_from"/>
                                    <field name="email_cc" groups="base.group_no_one"/>
                                    <field name="parent_id" groups="project.group_subtask_project"/>
                                    <field name="child_ids" invisible="1"/>
                                    <field name="subtask_project_id" invisible="1"/>
                                    <field name="company_id" groups="base.group_multi_company" options="{'no_create': True}"/>
                                    <field name="displayed_image_id" groups="base.group_no_one"/>
                                </group>
                                <group>
                                    <field name="date_assign" groups="base.group_no_one"/>
                                    <field name="date_last_stage_update" groups="base.group_no_one"/>
                                </group>
                                <group string="Working Time to Assign" attrs="{'invisible': [('working_hours_open', '=', 0.0)]}">
                                    <field name="working_hours_open" string="Hours"/>
                                    <field name="working_days_open" string="Days"/>
                                </group>
                                <group string="Working Time to Close" attrs="{'invisible': [('working_hours_close', '=', 0.0)]}">
                                    <field name="working_hours_close" string="Hours"/>
                                    <field name="working_days_close" string="Days"/>
                                </group>
                            </group>
                        </page>
                         <page string="Relación">
                           
                                    <group string="Correos">
                                      <div>
                                        <field name="x_relacion">
                                            <tree>
                                                <field name="date"/>
                                                <field name="subject"/>
                                                <field name="author_id"/>
                                                <field name="tipo_etiquetas"/>
                                            </tree>
                                        </field>
                                      </div>
                                  </group>
                        </page>
                    </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
            </form>
        </field>
    </record>

    <!-- Vista arbol Correos entrantes -->
    <record model="ir.ui.view" id="mail.message_view_tree">
        <field name="name">Pyme - Correos entrantes view_tree</field>
        <field name="model">mail.message</field>
        <field name="arch" type="xml">
            <tree string="Emails">
                    <field name="date"/>
                    <field name="subject"/>
                    <field name="author_id"/>
                    <field name="tipo_etiquetas" string="Etiquetas"/>
                    <field name="relacion" string="Relacionado con.."/>
            </tree>
        </field>
    </record>

    <!-- Vista formulario Correos entrantes -->
    <record model="ir.ui.view" id="mail.message_view_form">
        <field name="name">Pyme - Correos entrantes view_form</field>
        <field name="model">mail.message</field>
        <field name="arch" type="xml">
            <form string="Message" create="false">
                    <sheet>
                          <h2><field name="subject"/></h2>
                       <group>
                            <group>
                                <field name="date"/>
                                <field name="email_from"/>
                                <field name="author_id"/>
                                <field name="message_type" invisible="1"/>
                                <field name="record_name" invisible="1"/>
                                
                            </group>
                            <group>
                                <field name="parent_id" invisible="1"/>
                                <field name="model" invisible="1"/>
                                <field name="tipo_etiquetas" widget="many2many_tags"/>
						        <field name="relacion" on_change="onchange_relacion(rel_id)"/>
                                <field name="res_id" invisible="1"/>
                                
                                <field name="subtype_id" invisible="1"/>
                                <field name="rel_id" invisible="1"/>
                                <field name="tareas" attrs="{'invisible':[('rel_id','!=','TAREA')]}"/>
                                <field name="pedido_venta" attrs="{'invisible':[('rel_id','!=','PEDIDO VENTA')]}"/>
                                <field name="pedido_compra" attrs="{'invisible':[('rel_id','!=','PEDIDO COMPRA')]}"/>
                                <field name="albaran" attrs="{'invisible':[('rel_id','!=','ALBARAN')]}"/>
                                <field name="factura" attrs="{'invisible':[('rel_id','!=','FACTURA')]}"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Body">
                                <field name="body" options="{'style-inline': true}"/>
                            </page>
                            <page string="Gateway" invisible="1">
                                <group>
                                    <group>
                                        <field name="reply_to"/>
                                        <field name="no_auto_thread"/>
                                    </group>
                                    <group>
                                        <field name="message_id"/>
                                        <field name="mail_server_id"/>
                                    </group>
                                </group>
                            </page>
                            <page string="Recipients" invisible="1">
                                <group>
                                    <group>
                                        <field name="partner_ids" widget="many2many_tags"/>
                                        <field name="channel_ids" widget="many2many_tags"/>
                                    </group>
                                    <group>
                                        <field name="needaction_partner_ids" widget="many2many_tags"/>
                                        <field name="starred_partner_ids" widget="many2many_tags"/>
                                    </group>
                                </group>
                                <group>
                                    <field name="notification_ids">
                                        <tree>
                                            <field name="res_partner_id"/>
                                            <field name="is_read"/>
                                            <field name="is_email"/>
                                            <field name="email_status"/>
                                        </tree>
                                    </field>
                                </group>
                            </page>
                            <page string="Tracking" invisible="1">
                                <field name="tracking_value_ids"/>
                            </page>
                        </notebook>
                    </sheet>
            </form>
        </field>
    </record>

    <!-- Vista arbol Correos salientes -->
    <record model="ir.ui.view" id="mail.mail_view_tree">
        <field name="name">Pyme - Correos salientes view_tree</field>
        <field name="model">mail.mail</field>
        <field name="arch" type="xml">
            <tree string="Emails" decoration-muted="state in ('sent', 'cancel')" decoration-info="state=='outgoing'" decoration-danger="state=='exception'">
                    <field name="date"/>
                    <field name="subject"/>
                    <field name="author_id"/>
                    <field name="tipo_etiquetas" string="Etiquetas"/>
                    <field name="message_id" invisible="1"/>
                    <field name="recipient_ids" invisible="1"/>
                    <field name="model" invisible="1"/>
                    <field name="res_id" invisible="1"/>
                    <field name="email_from" invisible="1"/>
                    <field name="state" invisible="1"/>
                    <field name="message_type" invisible="1"/>
                    <button name="send" string="Send Now" type="object" icon="fa-paper-plane text-success" states="outgoing"/>
                    <button name="mark_outgoing" string="Retry" type="object" icon="fa-repeat text-success" states="exception,cancel"/>
                    <button name="cancel" string="Cancel Email" type="object" icon="fa-times-circle text-danger" states="outgoing"/>
            </tree>
        </field>
    </record>

    <!-- Vista formulario Correos salientes -->
    <record model="ir.ui.view" id="mail.mail_view_form">
        <field name="name">Pyme - Correos salientes view_form</field>
        <field name="model">mail.mail</field>
        <field name="arch" type="xml">
            <form string="Email message">
                    <header>
                        <button name="send" string="Send Now" type="object" states="outgoing" class="oe_highlight"/>
                        <button name="mark_outgoing" string="Retry" type="object" states="exception,cancel"/>
                        <button name="cancel" string="Cancel" type="object" states="outgoing"/>
                        <field name="state" widget="statusbar" statusbar_visible="outgoing,sent,received,exception,cancel"/>
                    </header>
                    <sheet>
                        <field name="mail_message_id" required="0" invisible="1"/>
                        <label for="subject" class="oe_edit_only"/>
                        <h2><field name="subject"/></h2>
                        <!--
                        <div style="vertical-align: top;">
                            by <field name="author_id" class="oe_inline" string="User"/> on <field name="date" readonly="1" class="oe_inline"/>
                            <button name="87" string="Reply" type="action" icon="fa-reply text-warning" context="{'default_composition_mode':'reply', 'default_parent_id': mail_message_id}" states="received,sent,exception,cancel"/>
                        </div>
                        -->
                        <group>
                            <field name="email_from"/>
                            <field name="email_to"/>
                            <field name="recipient_ids" widget="many2many_tags"/>
                            <field name="email_cc"/>
                            <field name="reply_to"/>
                            <field name="scheduled_date" invisible="1"/>
                            <field name="tipo_etiquetas" widget="many2many_tags"/>
                           
                        </group>
                        <notebook>
                            <page string="Body">
                                <field name="body_html" widget="html" options="{'style-inline': true}"/>
                            </page>
                            <page string="Advanced" groups="base.group_no_one" invisible="1">
                                <group>
                                    <group string="Status">
                                        <field name="auto_delete"/>
                                        <field name="notification"/>
                                        <field name="message_type"/>
                                        <field name="mail_server_id"/>
                                        <field name="model"/>
                                        <field name="res_id"/>
                                    </group>
                                    <group string="Headers">
                                        <field name="message_id"/>
                                        <field name="references"/>
                                        <field name="fetchmail_server_id"/>
                                        <field name="headers"/>
                                    </group>
                                </group>
                            </page>
                            <page string="Attachments">
                                <field name="attachment_ids"/>
                            </page>
                            <page string="Failure Reason" attrs="{'invisible': [('state', '!=', 'exception')]}">
                                <field name="failure_reason"/>
                            </page>
                        </notebook>
                    </sheet>
            </form>
        </field>
    </record>

    <!-- **************************************** ACCIONES **************************************** -->

    <!-- Action Calendario -->
    <record model="ir.actions.act_window" id="action_calendario">
        <field name="name">Pyme - Calendario</field>
        <field name="res_model">calendar.event</field>
        <field name="view_mode">calendar,tree,form</field>
        <field name="view_ids" eval="[(5, 0, 0),
                            (0, 0, {'view_mode': 'calendar', 'view_id': ref('calendar.view_calendar')})]"/>
    </record>

    <!-- Action Tareas -->
    <record model="ir.actions.act_window" id="action_tareas">
        <field name="name">Pyme - Tareas</field>
        <field name="res_model">project.task</field>
        <field name="view_mode">tree,form</field>
        <field name="view_ids" eval="[(5, 0, 0),
                            (0, 0, {'view_mode': 'tree', 'view_id': ref('project.task_view_tree')}),
                            (0, 0, {'view_mode': 'form', 'view_id': ref('project.task_view_form')})]"/>
    </record>

    <!-- Action Correo entrante -->
    <record model="ir.actions.act_window" id="action_correo_entrante">
        <field name="name">Pyme - Correos entrantes</field>
        <field name="res_model">mail.message</field>
        <field name="view_mode">tree,form</field>
        <field name="domain">[('message_type','=','email')]</field>
        <field name="view_ids" eval="[(5, 0, 0),
                            (0, 0, {'view_mode': 'tree', 'view_id': ref('mail.message_view_tree')}),
                            (0, 0, {'view_mode': 'form', 'view_id': ref('mail.message_view_form')})]"/>
    </record>

    <!-- Action Correo saliente -->
    <record model="ir.actions.act_window" id="action_correo_saliente">
        <field name="name">Pyme - Correos salientes</field>
        <field name="res_model">mail.mail</field>
        <field name="view_mode">tree,form</field>
        <field name="view_ids" eval="[(5, 0, 0),
                            (0, 0, {'view_mode': 'tree', 'view_id': ref('mail.mail_view_tree')}),
                            (0, 0, {'view_mode': 'form', 'view_id': ref('mail.mail_view_form')})]"/>
    </record>

    <!-- **************************************** ITEMS **************************************** -->

    <!-- Menú principal -->
    <menuitem id="menu_productividad" 
              name="Productividad" 
              web_icon="pyme_menus,static/menu/productividad.png"
              sequence="1"/>

    <menuitem id="item_action_calendario" 
              name="Calendario"
              parent="menu_productividad"
              action="action_calendario"/>

    <menuitem id="item_action_tareas" 
              name="Tareas"
              parent="menu_productividad"
              action="action_tareas"/>

    <menuitem id="item_action_correo_electronico" 
              name="Correo electrónico"
              parent="menu_productividad"/>

              <menuitem id="item_action_correo_entrante" 
                        name="Correo entrante"
                        parent="item_action_correo_electronico"
                        action="action_correo_entrante"/>

              <menuitem id="item_action_correo_saliente" 
                        name="Correo saliente"
                        parent="item_action_correo_electronico"
                        action="action_correo_saliente"/>
  
  
  </data>
</odoo>